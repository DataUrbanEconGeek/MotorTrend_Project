---
title: "Motor Trend Project"
author: "Andrew Rosa"
date: "11/12/2016"
output: 
        html_document:
                includes:
                        in_header: head.html
                css: style.css
---

### Background

The 1974 issue of Motor Trend US magazine contained a data-set on the fuel consumption and ten different aspects of design and performance for 32 automobiles. The goals of this project are to answer if  an automatic or manual transmission better for MPG, and How different is the MPG between automatic manual transmission? 

### First

We should take a look at the data. No need to load the data-set into the global environment, as R already has it. We'll use the function `str()` to get an overlook of the data.

```{r}
str(mtcars)
```

We can see that all of the variables in the data-set are numeric. Transmission should be a cator though: 0 marks automatic, and 1 marks manual. We'll need to fix this. We also don't see the names of the automobiles. This is because they are the row names of the data-set. Let's take a look at this as well. 

```{r}
mtcars$am <- factor(mtcars$am)
rownames(mtcars)
```

### Exploritory Visualization

Lets take a look at some histrograms to get an idea of the distrobutions. 

```{r echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
library(gridExtra)

plot_1 <- ggplot(mtcars, aes(x = mpg, fill  = I("#F8766D"))) +
                geom_density(fill = I("#00BFC4"), col = "#00BFC4", alpha = 0.5) +
                geom_histogram(aes(y = ..density..), alpha = 0.9)

plot_2 <- ggplot(mtcars, aes(x = disp, fill  = I("#F8766D"))) +
                geom_density(fill = I("#00BFC4"), col = "#00BFC4", alpha = 0.5) +
                geom_histogram(aes(y = ..density..), alpha = 0.9)

plot_3 <- ggplot(mtcars, aes(x = hp, fill  = I("#F8766D"))) +
                geom_density(fill = I("#00BFC4"), col = "#00BFC4", alpha = 0.5) +
                geom_histogram(aes(y = ..density..), alpha = 0.9)

plot_4 <- ggplot(mtcars, aes(x = drat, fill  = I("#F8766D"))) +
                geom_density(fill = I("#00BFC4"), col = "#00BFC4", alpha = 0.5) +
                geom_histogram(aes(y = ..density..), alpha = 0.9)

plot_5 <- ggplot(mtcars, aes(x = wt, fill  = I("#F8766D"))) +
                geom_density(fill = I("#00BFC4"), col = "#00BFC4", alpha = 0.5) +
                geom_histogram(aes(y = ..density..), alpha = 0.9)

grid.arrange(plot_1, plot_2, plot_3, plot_4, plot_5, ncol = 2)
```

```{r echo=FALSE, warning=FALSE, message=FALSE}
plot_6 <- ggplot(mtcars, aes(x = log(mpg), fill  = I("#F8766D"))) +
                geom_density(fill = I("#00BFC4"), col = "#00BFC4", alpha = 0.5) +
                geom_histogram(aes(y = ..density..), alpha = 0.9)

plot_7 <- ggplot(mtcars, aes(x = log(hp), fill  = I("#F8766D"))) +
                geom_density(fill = I("#00BFC4"), col = "#00BFC4", alpha = 0.5) +
                geom_histogram(aes(y = ..density..), alpha = 0.9)

plot_8 <- ggplot(mtcars, aes(x = log(wt), fill  = I("#F8766D"))) +
                geom_density(fill = I("#00BFC4"), col = "#00BFC4", alpha = 0.5) +
                geom_histogram(aes(y = ..density..), alpha = 0.9)

grid.arrange(plot_6, plot_7, plot_8, ncol = 2)
```

```{r echo=FALSE}
plot_9 <- ggplot(mtcars, aes(x = disp, y = mpg)) +
                geom_point()
plot_10 <- ggplot(mtcars, aes(x = disp, y = log(mpg))) +
                geom_point()
plot_11 <- ggplot(mtcars, aes(x = log(disp), y = log(mpg))) +
                geom_point()
plot_12 <- ggplot(mtcars, aes(x = hp, y = mpg)) +
                geom_point()
plot_13 <- ggplot(mtcars, aes(x = hp, y = log(mpg))) +
                geom_point()
plot_14 <- ggplot(mtcars, aes(x = log(hp), y = log(mpg))) +
                geom_point()
grid.arrange(plot_9, plot_10, plot_11, plot_12, plot_13, plot_14, ncol = 3)
```

```{r echo=FALSE}

var_names <- c("drat", "wt")
plot_list <- list()
for(i in var_names){
       temp_plot <- ggplot(mtcars, aes_string(x = i)) +
                        geom_point(aes(y = mpg)) +
                        annotate("text", x=Inf, y = Inf,
                                label = paste0("cor: ", 
                                        round(cor(mtcars[,i], mtcars$mpg), 2)),
                                vjust=1, hjust=1, col = "#F8766D")
       temp_plot2 <- ggplot(mtcars, aes_string(x = i)) +
                        geom_point(aes(y = log(mpg))) +
                        annotate("text", x=Inf, y = Inf,
                                label = paste0("cor: ", 
                                        round(cor(mtcars[,i], log(mtcars$mpg)), 2)),
                                vjust=1, hjust=1, col = "#F8766D")
       temp_plot3 <- ggplot(mtcars, aes_string(x = sprintf("log(%s)", i))) +
                        geom_point(aes(y = log(mpg))) +
                        annotate("text", x=Inf, y = Inf,
                                label = paste0("cor: ", 
                                        round(cor(log(mtcars[,i]), log(mtcars$mpg)), 2)),
                                vjust=1, hjust=1, col = "#F8766D")
       plot_list[[paste0(i, 1)]] <- temp_plot
       plot_list[[paste0(i, 2)]] <- temp_plot2
       plot_list[[paste0(i, 3)]] <- temp_plot3
}
grid.arrange(grobs = plot_list, ncol = 3)
```

```{r}
plot_30 <- ggplot(mtcars, aes(x = factor(cyl), y = mpg)) +
                geom_boxplot()
plot_31 <- ggplot(mtcars, aes(x = factor(vs), y = mpg)) +
                geom_boxplot()
plot_32 <- ggplot(mtcars, aes(x = factor(am), y = mpg)) +
                geom_boxplot()
plot_33 <- ggplot(mtcars, aes(x = factor(gear), y = mpg)) +
                geom_boxplot()
plot_34 <- ggplot(mtcars, aes(x = factor(carb), y = mpg)) +
                geom_boxplot()
grid.arrange(plot_30, plot_31, plot_32, plot_33, plot_34, ncol = 2)
```





